dsl_version: 0.7.0
service:
  name: elasticsearch
  ports:
    - {{ elasticsearch.port }}
    - {{ elasticsearch.cluster_port }}
  containers:
    - name: elasticsearch
      image: elasticsearch
      env:
        - name: NODE_DATA
          value: "false"
        - name: NODE_MASTER
          value: "true"
      daemon:
        files:
          - elasticsearch.yml
          - log4j2
        command: /usr/share/elasticsearch/bin/elasticsearch
    - name: cron
      image: cron
      daemon:
        command: cron -f
        files:
          - es-curator-config
          - es-curator-action-delete-indice
          - es-curator-cronjob

files:
  elasticsearch.yml:
    path: /usr/share/elasticsearch/config/elasticsearch.yml
    content: elasticsearch.yml.j2
  es-curator-config:
    path: /etc/curator/curator.yaml
    content: curator.yaml.j2
  es-curator-action-delete-indice:
    path: /etc/curator/action-delete-indice.yaml
    content: curator-action-delete-indice.yaml.j2
  es-curator-cronjob:
    path: /etc/cron.d/curator
    content: curator-cronjob
    perm: "0644"
  log4j2:
    path: /usr/share/elasticsearch/config/log4j2.properties
    content: log4j2.properties.j2
